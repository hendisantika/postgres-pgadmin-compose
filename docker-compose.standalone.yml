# Standalone mode - For servers WITH existing host nginx
# Usage: docker compose -f docker-compose.yml -f docker-compose.standalone.yml up -d
#
# This config exposes services on localhost only, letting host nginx handle SSL/proxying
# Copy nginx/sites-available/*.conf to your host nginx configuration
#
# Configure ports in .env:
#   STANDALONE_PGADMIN_PORT=5051
#   STANDALONE_MONITOR_PORT=8889

services:
  # Override postgres to bind to all interfaces for remote access via host nginx stream
  postgres:
    ports: !override
      - "${POSTGRES_BIND:-0.0.0.0}:${STANDALONE_POSTGRES_PORT:-5432}:5432"

  # Override pgadmin to bind to localhost only (host nginx will proxy)
  pgadmin:
    ports: !override
      - "127.0.0.1:${STANDALONE_PGADMIN_PORT:-5051}:80"

  # Override monitor to bind to localhost only (host nginx will proxy)
  monitor:
    ports: !override
      - "127.0.0.1:${STANDALONE_MONITOR_PORT:-8889}:8080"
